<!DOCTYPE html>
<html lang="en">
<head>
    <title>GuiLite preview</title>
</head>
<body>
    <canvas id="screen" width="1024" height="768"></canvas>
</body>

<script type="text/javascript">
function draw_single_widget(context, str, rect){
    console.log(rect.toString());
    context.fillStyle = "#FF0000";
    context.fillRect(rect[0], rect[1], rect[2], rect[3]);
    context.fillText(str, rect[0], rect[1]);
}

function draw_widgets(context, widgets){
    for( var i = 0; i < widgets.length; i++){
        rect = widgets[i].match(/[^A-Za-z_]\d+/g);
        string = "null"
        strings = widgets[i].match(/".*"/g);
        if(strings.length != 1){
            console.log('Invalid strings' + strings.length.toString() + ':' + strings.toString());
        }else{
            string = strings[0].replace(/"/g,'');//remove "
        }
        console.log(string.toString() + rect.toString());
        draw_single_widget(context, string, rect)
    }
}

function search_widgets(tree){
    var widgets = tree.match(/{ *&[^,]*,[^,]*,[^,]*,[^,]*,[^,]*,[^,]*,[^,]*/g);
    console.log(widgets.length.toString() + ':' + widgets.toString());
    return widgets;
}

function search_trees(source){
    var trees = source.match(/WND_TREE.*};$/mg);
    console.log(trees.length.toString() + ':' + trees.toString());
    return trees;
}

    const canvas = document.getElementById('screen');
    const context = canvas.getContext('2d');
    var source_code = 'static c_button s_exit_button;WND_TREE s_dialog_widgets[] = {	{&s_exit_button, ID_EXIT_BUTTON, "Exit", 50, 50, 100, 30}, {&s_exit_button, ID_EXIT_BUTTON, "Welcome", 100, 100, 100, 30}, {NULL, 0 , 0, 0, 0, 0, 0}};\n WND_TREE s_dialog_widgets1[] = {	{&s_exit_button, ID_EXIT_BUTTON, "Exit1", 150, 150, 100, 30}, {&s_exit_button, ID_EXIT_BUTTON, "Welcome_1", 200, 200, 100, 30}, {NULL, 0 , 0, 0, 0, 0, 0}};\n';

    var trees = search_trees(source_code);
    for( var i = 0; i < trees.length; i++){
    	var widgets = search_widgets(trees[i]);
    	draw_widgets(context, widgets);
    }
    
</script>
</html>